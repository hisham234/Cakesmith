{"ast":null,"code":"import _toConsumableArray from\"C:/Users/Lucifer/The Cakesmith/fyp-frontend/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";import _slicedToArray from\"C:/Users/Lucifer/The Cakesmith/fyp-frontend/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useEffect,useRef,useState}from'react';import socketIOClient from'socket.io-client';import'./ChatBox.css';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var ENDPOINT=window.location.host.indexOf('localhost')>=0?'http://127.0.0.1:5000':window.location.host;export default function ChatBox(props){var userInfo=props.userInfo;var _useState=useState(null),_useState2=_slicedToArray(_useState,2),socket=_useState2[0],setSocket=_useState2[1];var uiMessagesRef=useRef(null);var _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),isOpen=_useState4[0],setIsOpen=_useState4[1];var _useState5=useState(''),_useState6=_slicedToArray(_useState5,2),messageBody=_useState6[0],setMessageBody=_useState6[1];var _useState7=useState([{name:'Admin',body:'Hello there, Please ask your question.'}]),_useState8=_slicedToArray(_useState7,2),messages=_useState8[0],setMessages=_useState8[1];useEffect(function(){if(uiMessagesRef.current){uiMessagesRef.current.scrollBy({top:uiMessagesRef.current.clientHeight,left:0,behavior:'smooth'});}if(socket){socket.emit('onLogin',{_id:userInfo._id,name:userInfo.name,isAdmin:userInfo.isAdmin});socket.on('message',function(data){setMessages([].concat(_toConsumableArray(messages),[{body:data.body,name:data.name}]));});}},[messages,isOpen,socket]);var supportHandler=function supportHandler(){setIsOpen(true);console.log(ENDPOINT);var sk=socketIOClient(ENDPOINT);setSocket(sk);};var submitHandler=function submitHandler(e){e.preventDefault();if(!messageBody.trim()){alert('Error. Please type message.');}else{setMessages([].concat(_toConsumableArray(messages),[{body:messageBody,name:userInfo.name}]));setMessageBody('');setTimeout(function(){socket.emit('onMessage',{body:messageBody,name:userInfo.name,isAdmin:userInfo.isAdmin,_id:userInfo._id});},1000);}};var closeHandler=function closeHandler(){setIsOpen(false);};return/*#__PURE__*/_jsx(\"div\",{className:\"chatbox\",children:!isOpen?/*#__PURE__*/_jsx(\"button\",{type:\"button\",id:\"ChatBtnOpen\",onClick:supportHandler,children:\"Chat\"}):/*#__PURE__*/_jsxs(\"div\",{className:\"chatbox card-body\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"ChatTopDiv\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"ChatTopContent\",children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Support \"}),/*#__PURE__*/_jsx(\"button\",{type:\"buttonClose\",id:\"ChatBtnClose\",onClick:closeHandler,children:/*#__PURE__*/_jsx(\"i\",{className:\"fa fa-close\"})})]})}),/*#__PURE__*/_jsx(\"ul\",{ref:uiMessagesRef,id:\"ChatBoxUl\",children:messages.map(function(msg,index){return/*#__PURE__*/_jsxs(\"li\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"\".concat(msg.name,\": \")}),\" \",msg.body]},index);})}),/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsxs(\"form\",{onSubmit:submitHandler,className:\"ChatForm\",children:[/*#__PURE__*/_jsx(\"input\",{id:\"ChatInput\",value:messageBody,onChange:function onChange(e){return setMessageBody(e.target.value);},type:\"text\",placeholder:\"Type Message\"}),/*#__PURE__*/_jsx(\"button\",{type:\"submit\",children:\"Send\"})]})})]})});}","map":{"version":3,"sources":["C:/Users/Lucifer/The Cakesmith/fyp-frontend/src/components/ChatBox.js"],"names":["React","useEffect","useRef","useState","socketIOClient","ENDPOINT","window","location","host","indexOf","ChatBox","props","userInfo","socket","setSocket","uiMessagesRef","isOpen","setIsOpen","messageBody","setMessageBody","name","body","messages","setMessages","current","scrollBy","top","clientHeight","left","behavior","emit","_id","isAdmin","on","data","supportHandler","console","log","sk","submitHandler","e","preventDefault","trim","alert","setTimeout","closeHandler","map","msg","index","target","value"],"mappings":"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","sourcesContent":["import React, { useEffect, useRef, useState } from 'react';\r\nimport socketIOClient from 'socket.io-client';\r\nimport './ChatBox.css'\r\n\r\nconst ENDPOINT =\r\n  window.location.host.indexOf('localhost') >= 0\r\n    ? 'http://127.0.0.1:5000'\r\n    : window.location.host;\r\n\r\nexport default function ChatBox(props) {\r\n  const { userInfo } = props;\r\n  const [socket, setSocket] = useState(null);\r\n  const uiMessagesRef = useRef(null);\r\n  const [isOpen, setIsOpen] = useState(false);\r\n  const [messageBody, setMessageBody] = useState('');\r\n  const [messages, setMessages] = useState([\r\n    { name: 'Admin', body: 'Hello there, Please ask your question.' },\r\n  ]);\r\n\r\n  useEffect(() => {\r\n    if (uiMessagesRef.current) {\r\n      uiMessagesRef.current.scrollBy({\r\n        top: uiMessagesRef.current.clientHeight,\r\n        left: 0,\r\n        behavior: 'smooth',\r\n      });\r\n    }\r\n    if (socket) {\r\n      socket.emit('onLogin', {\r\n        _id: userInfo._id,\r\n        name: userInfo.name,\r\n        isAdmin: userInfo.isAdmin,\r\n      });\r\n      socket.on('message', (data) => {\r\n        setMessages([...messages, { body: data.body, name: data.name }]);\r\n      });\r\n    }\r\n  }, [messages, isOpen, socket]);\r\n\r\n  const supportHandler = () => {\r\n    setIsOpen(true);\r\n    console.log(ENDPOINT);\r\n    const sk = socketIOClient(ENDPOINT);\r\n    setSocket(sk);\r\n  };\r\n  const submitHandler = (e) => {\r\n    e.preventDefault();\r\n    if (!messageBody.trim()) {\r\n      alert('Error. Please type message.');\r\n    } else {\r\n      setMessages([...messages, { body: messageBody, name: userInfo.name }]);\r\n      setMessageBody('');\r\n      setTimeout(() => {\r\n        socket.emit('onMessage', {\r\n          body: messageBody,\r\n          name: userInfo.name,\r\n          isAdmin: userInfo.isAdmin,\r\n          _id: userInfo._id,\r\n        });\r\n      }, 1000);\r\n    }\r\n  };\r\n  const closeHandler = () => {\r\n    setIsOpen(false);\r\n  };\r\n  return (\r\n    <div className=\"chatbox\">\r\n      {!isOpen ? (\r\n        <button type=\"button\" id=\"ChatBtnOpen\" onClick={supportHandler}>\r\n          Chat \r\n        </button>\r\n      ) : (\r\n        <div className=\"chatbox card-body\">\r\n\r\n          <div className=\"ChatTopDiv\">\r\n            <div className=\"ChatTopContent\">\r\n                <strong>Support </strong>\r\n              <button type=\"buttonClose\" id=\"ChatBtnClose\" onClick={closeHandler}>\r\n                <i className=\"fa fa-close\" />\r\n              </button>\r\n            </div>\r\n          </div>\r\n          \r\n          <ul ref={uiMessagesRef} id=\"ChatBoxUl\">\r\n            {messages.map((msg, index) => (\r\n              <li key={index}>\r\n                <strong>{`${msg.name}: `}</strong> {msg.body}\r\n              </li>\r\n            ))}\r\n          </ul>\r\n\r\n          <div>\r\n            <form onSubmit={submitHandler} className=\"ChatForm\">\r\n              <input id=\"ChatInput\" value={messageBody} onChange={(e) => setMessageBody(e.target.value)} type=\"text\" placeholder=\"Type Message\"/>\r\n              <button type=\"submit\">Send</button>\r\n            </form>\r\n          </div>\r\n\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n}"]},"metadata":{},"sourceType":"module"}